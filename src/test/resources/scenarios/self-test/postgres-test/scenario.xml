<scenario xmlns="http://www.knubisoft.com/e2e/testing/model/scenario" onlyThis="true">

    <overview>
        <description>Self postgre SQL test</description>
        <name>PostgreSQL test scenario</name>
    </overview>
    <tags>
        <tag>self_test</tag>
    </tags>
    <migrate comment="Prepare information from news_init patch (5 records)"
             name="POSTGRES"
             alias="playground_db">
        <patches>postgres_patch_1.sql</patches>
    </migrate>

    <migrate comment="Prepare information from news_init patch (5 records)"
             name="POSTGRES"
             alias="cloud_db">
        <patches>postgres_patch_1.sql</patches>
    </migrate>

    <postgres comment="Execute mixed postgres commands (SELECT/INSERT/DELETE).
  Expect to see content from expected_2"
              alias="playground_db"
              file="expected_3.json">
        <query>SELECT * FROM t_user</query>
        <query>INSERT INTO t_user (id, username, email, email_verified, first_name, last_name, salt, password,
            is_active, last_login, locked, locked_cause, created_at, created_by,deleted_at, deleted_by)
            VALUES (9, 'testuser9', 'email9@gmail.com', true, 'testuser9', 'testuser9', '',
            '$2a$10$neQFs2lytkzy12dAj./dS.gWbzEKRzaEpgfAbb2Z1SeIMWF4WYCou',
            true, current_date + 1, false, null, '2021-09-29 18:06:16.000000', null, null, null);
        </query>
        <query>SELECT id FROM t_user WHERE id=9</query>
        <query>DELETE FROM t_user WHERE 1=1</query>
        <query>SELECT * FROM t_user</query>
    </postgres>

    <postgres comment="Execute mixed postgres commands (SELECT/INSERT/DELETE).
  Expect to see content from expected_3"
              alias="cloud_db"
              file="expected_4.json">
        <query>SELECT * FROM t_user</query>
        <query>INSERT INTO t_user (id, username, email, email_verified, first_name, last_name, salt, password,
            is_active, last_login, locked, locked_cause, created_at, created_by,deleted_at, deleted_by)
            VALUES (9, 'testuser9', 'email9@gmail.com', true, 'testuser9', 'testuser9', '',
            '$2a$10$neQFs2lytkzy12dAj./dS.gWbzEKRzaEpgfAbb2Z1SeIMWF4WYCou',
            true, current_date + 1, false, null, '2021-09-29 18:06:16.000000', null, null, null);
        </query>
        <query>SELECT id FROM t_user WHERE id=9</query>
        <query>DELETE FROM t_user WHERE 1=1</query>
        <query>SELECT * FROM t_user</query>
    </postgres>
</scenario>

